---
layout: article
title: 区块链：以太坊
date: 2021-02-18 00:11:00 +0800
tags: [Blockchain]
categories: blog
pageview: true
key: knowledge-of-blockchain-ETH
---

> 参考文献：
>
> - [完全理解以太坊智能合约](https://learnblockchain.cn/2018/01/04/understanding-smart-contracts/)



## 智能合约

以太坊的智能合约并非现实中常见的合同，而是存在区块链上，可以被触发执行的一段程序代码，这些代码实现了某种预定的规则，是存在于以太坊执行环境中的“自治代理”。以太坊的账户与合约如下图 所示。

![image-20210222170422467](https://raw.githubusercontent.com/jjzhou012/image/master/blogImg20210222170422.png)

以太坊的智能合约设计很简明。

- 任何人都可以在以太坊区块链上开发智能合约，这些智能合约的代码是存在于以太坊的账户中的，这类存有代码的账户叫合约账户。对应地，由密钥控制的账户可称为外部账户。
- 以太坊的智能合约程序，是在以太坊虚拟机（Ethereum Virtual Machine,EVM）上运行的。
- 合约账户不能自己启动运行自己的智能合约。要运行一个智能合约，需要由外部账户对合约账户发起交易，从而启动其中的代码的执行。

## 账户

以太坊有两种账户，如下图所示：

- 外部账户（externally owned accounts），由密钥控制。
  - **地址**：是帐户的唯一标识符，与常规用户帐户一样。
  - **余额**（有多少钱： 以太）
- 合约账户（contract accounts），由[智能合约](http://c.biancheng.net/view/1917.html)的代码控制。
  - **地址**：智能合约的余额意味着代码可以拥有资金，它可以管理资金。
  - **余额**（有多少钱： 以太）
  - **状态**：智能合约中声明的所有变量和变量的当前状态
  - **代码**：编译后可以在以太坊客户端和节点可以运行的字节码。

![image-20210222205545535](https://raw.githubusercontent.com/jjzhou012/image/master/blogImg20210222205545.png)



## 以太坊和比特币在交易层面的区别

比特币交易非常简单，它只做一件事，就是进行交易。 忽略细节，这一切都归结为 **TO**（谁收钱），**FROM**（谁汇款）和 **AMOUNT**（多少钱）。 这让比特币网络中的参与者可以传递价值并存储价值。

以太坊很大的不同是其交易还有一个 `DATA` 字段。 DATA 字段支持三种类型的交易：

- 价值传递 (和比特币相同)
  - **TO** ：收款地址
  - **DATA** ：留空或留言信息
  - **FROM** ：谁发出
  - **AMOUNT** ：发送多少
- 创建合约
  - **TO** ：留空 (这就是触发创建智能合约的原因)
  - **DATA** ：包含编译为字节码的智能合约代码
  - **FROM** ：谁创建
  - **AMOUNT** ：可以是零或任何数量的以太，它是我们想要给合约的存款。
- 调用合约函数
  - **TO**： 目标合约账户地址
  - **DATA**： 包含函数名称和参数 - 标识如何调用智能合约函数
  - **FROM** ：谁调用
  - **AMOUNT** ： 可以是零或任意数量的以太，例如可以支付合约服务费用。



## 以太坊代币

在以太坊系统中，存在作为基础货币的 Ether（以太），以及同样可以作为货币使用的 Token（代币）。

以太坊与其他加密货币的主要不同在于，以太坊不是单纯的货币，而是一个环境/平台。在这个平台上，任何人都可以利用区块链的技术，通过智能合约来构建自己的项目和DAPPS（去中心化应用）。

如果把以太坊理解成互联网，DAPPS则是在上面运行的网页。DAPPS是去中心化的，意味着它不属于某个人，而是属于一群人。DAPPS发布的方式通常是采用被称为 ICO 的众筹方式。简单来说，你需要用你的以太来购买相应DAPP的一些tokens。

**一般有两种Token：**

1. Usage Tokens: 就是对应 DAPP 的原生货币。Golem 就是一个很好的例子，如果你需要使用 Golem 的服务，你就需要为其支付 Golem Network Token（GNT）。由于这种 Tokens 有货币价值，所以通常不会有其他的权益。
2. Work Tokens: 此类 Tokens 可以标识你对于 DAPP 的某种股东权益。以 DAO tokens 为例，如果你拥有 DAO tokens，那么你有权就DAO是否资助某款 DAPP 来进行投票。

类比到股权，可以把 Usage Tokens 简单理解为普通流通股，可以与真实货币兑换，本身具有价值。而 Work Token，则大致相当于投票权。

**为何需要Token:**

不是有以太基础货币了，那为什么还需要 token 呢？可以想下现实生活的真实场景，在游乐场里，我们需要用现金兑换代币，然后用代币支付各种服务。 类比到以太坊，现金就是以太，代币就是 token，用 token 来执行合约中的各项功能。